# Введение в BI (семинары)
## Урок 1. Из каких этапов состоит подготовка отчета
Скачайте Power BI Desktop - в качестве подтверждения присылайте скрин интерфейса.
Распишите подробнее свой путь в аналитике и ожидания от обучения:
Есть ли у вас опыт в аналитике и сколько лет?
В каком направлении анализа планируете развиваться: BI, бизнес, финансовый, маркетинговый, HR, системный, продуктовая? Возможно вы руководитель или владелец бизнеса, тогда распишите как поможет аналитика в ваших задачах.
Какие основные навыки вы хотите освоить?
Есть ли у вас уже опыт работы в какой-то BI-системе и если да, то какой?

## Урок 2. Как правильно оформить визуальный элемент

Дополните вкладку дашборда визуализациями (та, что мы делали на занятии) , чтобы с помощью них отразить метрики или ответить на вопросы:
1.1. Количество конверсий по браузерам.
1.2. На какие модели авто приходили конверсии?
1.3. Какая марка лидирует по количеству конверсий, насколько большой отрыв между марками?
1.4. Из каких источников приходили конверсии

В конверсиях по городам уберите значение “(not set)”

Установите цветовую схему, используя предложенные сервисы.

Добавьте фильтры по:

4.1 дате (подумайте, как сделать фильтр по дате удобным для выбора диапазона)

4.2 региону и городу ( попробуйте протестировать на Томске и Томской области)

4.3 источнику ( на примере, если заказчик хочет найти источник по слову yan...)


Присылайте в формате pbix и PDF.

Критерии приемки:

1) Сделаны + 4 визуализации в работе, начатой на семинаре

2) Сделаны +3 фильтра, фильтрами пользоваться удобно

3) Типы визуализаций выбраны корректно

4) Нет "визуального шума"

5) Учтены "Золотые правила"

6) все визуализации на одной вкладке!.

1) Верстка холста 16:9 или 1920 на 1080 в пикселях

2) Подписи значений и подписи заголовков отличаются на 2 пункта. 

3) Включена либо ось-шкала либо метки данных на диаграммах, графиках

4) никакой легенды в кольцевых/круговых. Имя категории выводим через содержимое метки данных

5) Имена осей отключаем

6) Высота линейчатых приемлемая, на уровне топ 12



## Урок 3. Создание дашборда

1) Доработайте работу по замечаниям ДЗ №2 ( если замечания были).
Убедитесь, что у вас добавлены фильтры из ДЗ №2.
+доделать классную работу, настроить перекрестное взаимодействие элементов, карту, переключение линейчатой в регионов на города и обратно ( см семинар)

2) Усовершенствуйте визуализацию, которую вы сделали на занятии:
Расположите элементы в файле так, чтобы они поместились на одной странице: используйте переключатели/закладки/подсказки/детализации

3) Взгляните критическим взглядом на свою работу:
- симметричны ли элементы?
- нет ли избыточности в названиях, подписях?
- правильно ли выбрана визуализация? ( Вспомните про "Золотые правила визуализации")

4) Опционально (не обязательно) : зарегистрируйте аккаунт для powerbi.com и опубликуйте работу в облаке ( Моя рабочая область –Отправить).

Работу присылаем в формате PBIX

### Выполение

1. К линейчатой диаграмме " По городам и регионам добавлена подсказка в виде всплывающей карты 320х320
	1. Фильтрация настроена на ТОП 30
	2. Как передать надпись фильтрации в название для ПОДСКАЗКИ (например При наведении на Адегею - карта Адегеи с названием Адыгея)
2. Добавлена кнопка Отчистить срезы, в минималистском виде
3. Добавлена кнопка с авторской иконкой - Действие: переход на карту (ТОП 10 по городам)	
4. Настроена подсказка **По ключевым словам** для раздела **По Источникам** и раздела **По Браузарм**
	1. По источникам много недостающих данных
	2. По браузерам видно что только владельцы Safari искали по слову `Mersedes`, повальное большиство искали `KIA`
3. Настроена подсказка для раздела **По устройствам** --> **По каналам трафика**
	1.  desktop --> referal 50%
	2.  mobile --> referal 29%
	3.  tablet -> referal 22%, но больше всего organic 50%

Кольцевой график как подсказка кольцевому графику смотрится плохо, отвлекает (выбрана линейчатая)

#### Условное наименование элемента
```
MapTitleRegionCity =
IF (
    NOT ISBLANK ( SELECTEDVALUE ( 'Маркетинговые данные'[Region] ) ),
    "Регион: " & SELECTEDVALUE ( 'Маркетинговые данные'[Region], "" ) & " "
        & IF (
            NOT ISBLANK ( SELECTEDVALUE ( 'Маркетинговые данные'[City] ) ),
            "Город :" & SELECTEDVALUE ( 'Маркетинговые данные'[City], "" )
        )
)
```

Таким же образом возможно форматирование всплывающих подсказок через отдельную страницу посказки, карточку и меру.
```
Использовано мера и подсказка: MarkTitle = SELECTEDVALUE('Маркетинговые данные'[Марка])
```

#Урок 4. Как подготовить данные их первоисточника к последующему анализу и визуализации

1) Скачайте по ссылке данные из CRM и Справочник:
https://docs.google.com/spreadsheets/d/1vev2uOhVs4PS7vMxLRWi9DocrlWGSj8I/export?format=xlsx

2) Скачайте данные по курсам валют с сайта ЦБ РФ

3) Сравните параметр продажи из CRM и из маркетинговых данных и удалите столбец с неполными данными.Таблица, в которой данных больше - полная!
Столбец продажи должен остаться только в одной таблице!

**Ответ:** В таблице **Маркетинговые данные** информация только о 86 продажах, в таблице **Данные из CRM** Инфорации о продажах > 1000.

4) В столбце Валюта в справочнике замените название валюты на то, как обозначена валюта в данных из ЦБ
В качестве домашней работы присылайте файл PBIX.


# Урок 4. Как подготовить данные их первоисточника к последующему анализу и визуализации
1) Скачайте по ссылке данные из CRM и Справочник:

https://docs.google.com/spreadsheets/d/1vev2uOhVs4PS7vMxLRWi9DocrlWGSj8I/export?format=xlsx

2) Скачайте данные по курсам валют с сайта ЦБ РФ
3) Сравните параметр продажи из CRM и из маркетинговых данных и удалите столбец с неполными данными.Таблица, в которой данных больше - полная!
Столбец продажи должен остаться только в одной таблице!
4) В столбце Валюта в справочнике замените название валюты на то, как обозначена валюта в данных из ЦБ
В качестве домашней работы присылайте файл PBIX.

# Урок 5. Алгоритмы математических и статистических функций для расчета

Расчетные столбцы:

1. Досчитайте в справочнике недостающие данные: цену автомобиля в рублях (берем курс ЦБ), маржу в рублях. Важно: в лекции упоминался способ "подтягивания" полей связанных таблиц.
DAX - меры

```
Цена в рублях =
IF (
    RELATED ( 'Курсы валют'[Букв. код] ) == 'Справочник'[Буквенный код Валюта],
    RELATED ( 'Курсы валют'[Курс] ),
    1
) * 'Справочник'[Цена]
```

2. Посчитайте и добавьте в визуализацию количество уникальных пользователей и сделайте формат текста в визуализации с пробелом для тысяч.

3. Рассчитайте одной цифрой сколько было приходов к дилеру по топ трем городам и выведете показатель в визуализацию

4. Рассчитайте среднюю стоимость марки автомобиля в рублях, визуализируйте показатель.

	Задачки со звездочками ( опционально, для тех, кто чувствует силы)

5. Реализовать расчет приходов топ-3 (из задания 3) через табличный DAX, где ТОП определяется функцией.

6. Рассчитать кол-во повторников ( а лучше долю) ( клиенты, совершившие более 1 покупки) и вывести в визуализацию.

Как сдавать работу:
Готовим отдельную вкладку (черновик) с расчетами. Можно ее назвать "Расчеты DAX".
Вкладка временная, после закрепления материала и проверки расчетов мы перенесем ряд визуализаций и вкладку удалим.
Файл присылать в формате PBIX.

# Урок 6. Что нам нужно делать с отчетом после его создания

1. Создайте отдельную страницу “Анализ продаж” (ее мы начали создавать на семинаре №6). Сохраните стилевое оформление

2. Сделайте дерево декомпозиций на странице “Анализ продаж” для клиентов с продажами, объясните метрику с помощью 2-4 ключевых категорий

3. Перенесите на страницу “Анализ продаж” визуальные элементы, с расчетами DAX (наиболее интересные и относящиеся к продажам)

4. Сделайте на новой странице “Анализ продаж” фильтры для любых полезных показателей на ваш выбор

Доп задача:

5. Опционально: настройте переключение матрицы с помощью кнопок с абсолютных величин в относительные. Каждый шаг Воронки - % доля от предыдущего.
Поэкспериментируйте с условным форматированием для новой матрицы( тепловая карта, один цвет, на 4 относительных столбца)

На этом этапе работ у Вас: 2 активные вкладки : Анализ конверсий, Анализ продаж
Скрытые вкладки: подсказки, детализации

Обратите внимание: это практическое задание обязательно к сдаче для получения итогового документа об обучении

# Homework 06 final

![](/pic/pic01.png)
![](/pic/pic02.png)
![](/pic/pic03.png)


# Полезное
Форматирование DAX
[https://www.daxformatter.com/](https://www.daxformatter.com/ "DAX Formater")


Справочсник DAX функций
[https://learn.microsoft.com/en-us/dax/sum-function-dax](https://learn.microsoft.com/en-us/dax/sum-function-dax)

#### HASONEVALUE

```
TitleDinamics =
IF (
    HASONEVALUE ( 'Маркетинговые данные'[Region] ),
    "Динамика контекста" & FORMAT ( 'Меры'[MapTitleRegionCity], "text" ),
    "Динамика"
)
```

#### IF

```
Price Group =
IF(
    'Product'[List Price] < 500,
    "Low",
    IF(
        'Product'[List Price] < 1500,
        "Medium",
        "High"
    )
)
```

#### Календарь

```
Календарь = 
ADDCOLUMNS(
 CALENDAR(min('Маркетинговые данные'[Date]),max('Маркетинговые данные'[Date])),
"День",FORMAT([Date], "DD.MM.YYYY"),
"Неделя",FORMAT(MAX( DATE(YEAR([Date]),1,1), [Date]-WEEKDAY([Date],3) ),"DD.MMM") & "-" & FORMAT(MIN( DATE(YEAR([Date]),12,31), [Date]+7-WEEKDAY([Date],2) ),"DD.MMM"),
"Месяц",FORMAT([Date], "MMMM YYYY"),
"Год",YEAR([Date]),
"День недели",FORMAT([Date], "DDDD"),
"Месяц сортировка", FORMAT([Date], "YYYYMM"),
"Номер недели",WEEKNUM([Date], 2),
"Неделя сортировка",IF(LEN(WEEKNUM([Date], 2)) = 1, FORMAT(YEAR([Date]),"")&"0"&FORMAT(WEEKNUM([Date], 2),""), FORMAT(YEAR([Date]),"")&""&FORMAT(WEEKNUM([Date], 2),"")),
"День сортировка", FORMAT([Date],"YYYYMMDD"),
"Имя месяца", FORMAT([Date],"MMM"),
"Месяц номер", MONTH([Date])
)
```